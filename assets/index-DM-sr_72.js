var e=Object.defineProperty,t=(t,n,o)=>((t,n,o)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o)(t,"symbol"!=typeof n?n+"":n,o);import{p as n}from"./phaser-C2_wa_Fb.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var o={i8:"i8",ui8:"ui8",ui8c:"ui8c",i16:"i16",ui16:"ui16",i32:"i32",ui32:"ui32",f32:"f32",f64:"f64",eid:"eid"},r={i8:"Int8",ui8:"Uint8",ui8c:"Uint8Clamped",i16:"Int16",ui16:"Uint16",i32:"Int32",ui32:"Uint32",eid:"Uint32",f32:"Float32",f64:"Float64"},s={i8:Int8Array,ui8:Uint8Array,ui8c:Uint8ClampedArray,i16:Int16Array,ui16:Uint16Array,i32:Int32Array,ui32:Uint32Array,f32:Float32Array,f64:Float64Array,eid:Uint32Array},i=e=>4*Math.ceil(e/4),a=Symbol("storeRef"),c=Symbol("storeSize"),l=Symbol("storeMaps"),h=Symbol("storeFlattened"),d=Symbol("storeBase"),u=Symbol("storeType"),f=Symbol("storeArrayElementCounts"),m=Symbol("storeSubarrays"),y=Symbol("subarrayCursors"),p=Symbol("subarray"),g=Symbol("parentArray"),S=Symbol("tagStore"),w=Symbol("indexType"),b=Symbol("indexBytes"),E=Symbol("isEidType"),v={},A=(e,t)=>{e[h]&&e[h].forEach((e=>{ArrayBuffer.isView(e)?e[t]=0:e[t].fill(0)}))},M=e=>Array.isArray(e)&&"string"==typeof e[0]&&"number"==typeof e[1],O=()=>{const e=[],t=[];e.sort=function(n){const o=Array.prototype.sort.call(this,n);for(let r=0;r<e.length;r++)t[e[r]]=r;return o};const n=n=>e[t[n]]===n;return{add:o=>{n(o)||(t[o]=e.push(o)-1)},remove:o=>{if(!n(o))return;const r=t[o],s=e.pop();s!==o&&(e[r]=s,t[s]=r)},has:n,sparse:t,dense:e,reset:()=>{e.length=0,t.length=0}}},I=Symbol("entityMasks"),x=Symbol("entityComponents"),T=Symbol("entitySparseSet"),k=Symbol("entityArray"),C=0,P=[],j=new Map,L=e=>{const t=e[ue]?P.length?P.shift():C++:P.length>Math.round(1e3)?P.shift():C++;if(t>e[ae])throw new Error("bitECS - max entities reached");return e[T].add(t),j.set(t,e),e[q].forEach((n=>{J(e,n,t)&&X(n,t)})),e[x].set(t,new Set),t},F=Symbol("$modifier"),R=e=>function(e,t){const n=()=>[e,"not"];return n[F]=!0,n}(e),D=Symbol("queries"),q=Symbol("notQueries"),U=Symbol("queryAny"),B=Symbol("queryAll"),N=Symbol("queryNone"),_=Symbol("queryMap"),H=Symbol("$dirtyQueries"),W=Symbol("queryComponents"),z=Object.freeze([]),Y=e=>t=>{t[_].has(e)||G(t,e);const n=t[_].get(e);if(0===n.entered.dense.length)return z;{const e=n.entered.dense.slice();return n.entered.reset(),e}},$=e=>t=>{t[_].has(e)||G(t,e);const n=t[_].get(e);if(0===n.exited.dense.length)return z;{const e=n.exited.dense.slice();return n.exited.reset(),e}},G=(e,t)=>{const n=[],o=[],r=[];t[W].forEach((t=>{if("function"==typeof t&&t[F]){const[s,i]=t();e[te].has(s)||oe(e,s),"not"===i&&o.push(s),"changed"===i&&(r.push(s),n.push(s))}else e[te].has(t)||oe(e,t),n.push(t)}));const s=t=>e[te].get(t),i=n.concat(o).map(s),a=O(),c=O(),l=O(),d=O(),u=i.map((e=>e.generationId)).reduce(((e,t)=>(e.includes(t)||e.push(t),e)),[]),f=(e,t)=>(e[t.generationId]||(e[t.generationId]=0),e[t.generationId]|=t.bitflag,e),m=n.map(s).reduce(f,{}),y=o.map(s).reduce(f,{}),p=i.reduce(f,{}),g=n.filter((e=>!e[S])).map((e=>Object.getOwnPropertySymbols(e).includes(h)?e[h]:[e])).reduce(((e,t)=>e.concat(t)),[]),w=Object.assign(a,{archetypes:[],changed:[],components:n,notComponents:o,changedComponents:r,allComponents:i,masks:m,notMasks:y,hasMasks:p,generations:u,flatProps:g,toRemove:c,entered:l,exited:d,shadows:[]});e[_].set(t,w),e[D].add(w),i.forEach((e=>{e.queries.add(w)})),o.length&&e[q].add(w);for(let h=0;h<C;h++)e[T].has(h)&&J(e,w,h)&&X(w,h)},Q=(e,t)=>{const n=Symbol(),o=e.flatProps[t];return((e,t)=>{if(ArrayBuffer.isView(e))e[t]=e.slice(0);else{const n=e[g].slice(0);e[t]=e.map(((t,o)=>{const{length:r}=e[o],s=r*o,i=s+r;return n.subarray(s,i)}))}})(o,n),e.shadows[t]=o[n],o[n]},V=(...e)=>{let t;if(Array.isArray(e[0])&&(t=e[0]),void 0===t||void 0!==t[te])return e=>e?e[k]:t[k];const n=function(e,t=!0){e[_].has(n)||G(e,n);const o=e[_].get(n);return Z(e),o.changedComponents.length?((e,t)=>{t&&(e.changed=[]);const{flatProps:n,shadows:o}=e;for(let r=0;r<e.dense.length;r++){const t=e.dense[r];let s=!1;for(let r=0;r<n.length;r++){const i=n[r],a=o[r]||Q(e,r);if(ArrayBuffer.isView(i[t])){for(let e=0;e<i[t].length;e++)if(i[t][e]!==a[t][e]){s=!0;break}a[t].set(i[t])}else i[t]!==a[t]&&(s=!0,a[t]=i[t])}s&&e.changed.push(t)}return e.changed})(o,t):o.dense};return n[W]=t,n[U]=void 0,n[B]=void 0,n[N]=void 0,n},J=(e,t,n)=>{const{masks:o,notMasks:r,generations:s}=t;for(let i=0;i<s.length;i++){const t=s[i],a=o[t],c=r[t],l=e[I][t][n];if(c&&l&c)return!1;if(a&&(l&a)!==a)return!1}return!0},X=(e,t)=>{e.toRemove.remove(t),e.entered.add(t),e.add(t)},K=e=>{for(let t=e.toRemove.dense.length-1;t>=0;t--){const n=e.toRemove.dense[t];e.toRemove.remove(n),e.remove(n)}},Z=e=>{e[H].size&&(e[H].forEach(K),e[H].clear())},ee=(e,t,n)=>{t.has(n)&&!t.toRemove.has(n)&&(t.toRemove.add(n),e[H].add(t),t.exited.add(n))},te=Symbol("componentMap"),ne=(e,t)=>{const n=((e,t)=>{const n=Symbol("store");if(!e||!Object.keys(e).length)return v[n]={[c]:t,[S]:!0,[d]:()=>v[n]},v[n];e=JSON.parse(JSON.stringify(e));const A={},O=e=>{const t=Object.keys(e);for(const n of t)M(e[n])?(A[e[n][0]]||(A[e[n][0]]=0),A[e[n][0]]+=e[n][1]):e[n]instanceof Object&&O(e[n])};O(e);const I={[c]:t,[l]:{},[m]:{},[a]:n,[y]:Object.keys(s).reduce(((e,t)=>({...e,[t]:0})),{}),[h]:[],[f]:A};if(e instanceof Object&&Object.keys(e).length){const a=(e,l)=>{if("string"==typeof e[l])e[l]=((e,t)=>{const n=t*s[e].BYTES_PER_ELEMENT,r=new ArrayBuffer(n),i=new s[e](r);return i[E]=e===o.eid,i})(e[l],t),e[l][d]=()=>v[n],I[h].push(e[l]);else if(M(e[l])){const[t,a]=e[l];e[l]=((e,t,n)=>{const a=e[c],l=Array(a).fill(0);l[u]=t,l[E]=t===o.eid;const h=e[y],d=n<=256?o.ui8:n<=65536?o.ui16:o.ui32;if(!n)throw new Error("bitECS - Must define component array length");if(!s[t])throw new Error(`bitECS - Invalid component array property type ${t}`);if(!e[m][t]){const n=e[f][t],o=new s[t](i(n*a));o[w]=r[d],o[b]=s[d].BYTES_PER_ELEMENT,e[m][t]=o}const S=h[t],v=S+a*n;h[t]=v,l[g]=e[m][t].subarray(S,v);for(let o=0;o<a;o++){const e=n*o,t=e+n;l[o]=l[g].subarray(e,t),l[o][w]=r[d],l[o][b]=s[d].BYTES_PER_ELEMENT,l[o][p]=!0}return l})(I,t,a),e[l][d]=()=>v[n],I[h].push(e[l])}else e[l]instanceof Object&&(e[l]=Object.keys(e[l]).reduce(a,e[l]));return e};return v[n]=Object.assign(Object.keys(e).reduce(a,e),I),v[n][d]=()=>v[n],v[n]}})(e,1e5);return e&&Object.keys(e).length,n},oe=(e,t)=>{if(!t)throw new Error("bitECS - Cannot register null or undefined component");const n=new Set,o=new Set,r=new Set;e[D].forEach((e=>{e.allComponents.includes(t)&&n.add(e)})),e[te].set(t,{generationId:e[I].length-1,bitflag:e[ce],store:t,queries:n,notQueries:o,changedQueries:r}),(e=>{e[ce]*=2,e[ce]>=2**31&&(e[ce]=1,e[I].push(new Uint32Array(e[ae])))})(e)},re=(e,t,n)=>{const o=e[te].get(t);if(!o)return!1;const{generationId:r,bitflag:s}=o;return(e[I][r][n]&s)===s},se=(e,t,n,o=!1)=>{if(void 0===n)throw new Error("bitECS - entity is undefined.");if(!e[T].has(n))throw new Error("bitECS - entity does not exist in the world.");if(e[te].has(t)||oe(e,t),re(e,t,n))return;const r=e[te].get(t),{generationId:s,bitflag:i,queries:a,notQueries:c}=r;e[I][s][n]|=i,a.forEach((t=>{t.toRemove.remove(n);const o=J(e,t,n);o&&(t.exited.remove(n),X(t,n)),o||(t.entered.remove(n),ee(e,t,n))})),e[x].get(n).add(t),o&&A(t,n)},ie=(e,t,n,o=!0)=>{if(void 0===n)throw new Error("bitECS - entity is undefined.");if(!e[T].has(n))throw new Error("bitECS - entity does not exist in the world.");if(!re(e,t,n))return;const r=e[te].get(t),{generationId:s,bitflag:i,queries:a}=r;e[I][s][n]&=~i,a.forEach((t=>{t.toRemove.remove(n);const o=J(e,t,n);o&&(t.exited.remove(n),X(t,n)),o||(t.entered.remove(n),ee(e,t,n))})),e[x].get(n).delete(t),o&&A(t,n)},ae=Symbol("size"),ce=Symbol("bitflag"),le=Symbol("archetypes"),he=Symbol("localEntities"),de=Symbol("localEntityLookup"),ue=Symbol("manualEntityRecycling"),fe=e=>(t,...n)=>(e(t,...n),t),me=o;const ye=ne({x:me.i32,y:me.i32}),pe=.5*(Math.sqrt(3)-1),ge=(3-Math.sqrt(3))/6,Se=e=>0|Math.floor(e),we=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]);const be=ne({row:me.ui16,col:me.ui16});var Ee=(e=>(e[e.Sea=0]="Sea",e[e.Plain=1]="Plain",e[e.Tree=2]="Tree",e[e.Forest=3]="Forest",e))(Ee||{});const ve=ne({type:me.ui8,cost:me.ui8,unit:me.eid}),Ae=ne(),Me=ne(),Oe=ne({movement:me.ui8,tile:me.eid,hp:me.ui8,attackPower:me.ui8,def:me.ui8}),Ie=ne();function xe(e,t,n){const o=[],r=e%t,s=Math.floor(e/t);return s>0&&o.push(e-t),s<n&&o.push(e+t),r>0&&o.push(e-1),r<t&&o.push(e+1),o}const Te=ne();class ke extends n.GameObjects.Image{constructor(e,t,n,o,r){super(e,t,n,o,r),this.setScale(4),this.setOrigin(0),this.setDepth(1),this.disableInteractive()}}class Ce{constructor(e,o){t(this,"container"),t(this,"width"),t(this,"height"),this.width=200,this.height=200;const{width:r}=e.scale;this.container=e.add.container(ye.x[o]>r/2?5:r-5-this.width,5).setDepth(100).setScrollFactor(0,0).disableInteractive();const s=e.add.nineslice(0,0,"panel-brown",0,this.width/2,this.width/2,60,40,49,49).setOrigin(0,0).setScale(2);this.container.add(s);const i=new n.Geom.Line(15,15,15,15+this.height),a=[],c=e.add.text(0,0,`HP: ${Oe.hp[o].toString()}`,{color:"#000000"}).setDepth(102).setScrollFactor(0,0).setOrigin(0,0);a.push(c);const l=e.add.text(0,0,`Attack Power: ${Oe.attackPower[o].toString()}`,{color:"#000000"}).setDepth(102).setScrollFactor(0,0).setOrigin(0,0);a.push(l);const h=e.add.text(0,0,`Defense: ${Oe.def[o].toString()}`,{color:"#000000"}).setDepth(102).setScrollFactor(0,0).setOrigin(0,0);a.push(h),n.Actions.PlaceOnLine(a,i),this.container.add(a),e.input.on("pointerup",(()=>{null!==this.container&&1!==this.container.alpha&&this.container.setAlpha(1)})),e.input.on("pointermove",(e=>{e.isDown&&null!==this.container&&1===this.container.alpha&&this.container.setAlpha(.7)}))}destroy(){null!==this.container&&this.container.destroy(),this.container=null}}const Pe=ne();class je extends n.GameObjects.Sprite{constructor(e,t,n,o,r){super(e,t,n,o,r),this.setScale(4),this.setOrigin(0),this.setDepth(1),this.setInteractive()}}class Le extends n.Scene{constructor(){super({key:"MainScene"}),t(this,"world"),t(this,"tileSystem"),t(this,"unitSystem"),t(this,"unitSelectionSystem"),t(this,"cameraSystem"),t(this,"tintSystem"),t(this,"movementSystem"),t(this,"actionSystem"),t(this,"phaseSystem"),t(this,"unitSprites"),t(this,"tiles")}create(){this.world=((...e)=>{const t="object"==typeof e[0]?e[0]:{};return((e,t=1e5)=>{e[ae]=t,e[k]&&e[k].forEach((t=>((e,t)=>{if(e[T].has(t)){e[D].forEach((n=>{ee(e,n,t)})),e[ue]||P.push(t),e[T].remove(t),e[x].delete(t),e[he].delete(e[de].get(t)),e[de].delete(t);for(let n=0;n<e[I].length;n++)e[I][n][t]=0}})(e,t))),e[I]=[new Uint32Array(t)],e[x]=new Map,e[le]=[],e[T]=O(),e[k]=e[T].dense,e[ce]=1,e[te]=new Map,e[_]=new Map,e[D]=new Set,e[q]=new Set,e[H]=new Set,e[he]=new Map,e[de]=new Map,e[ue]=!1})(t,"number"==typeof e[0]?e[0]:"number"==typeof e[1]?e[1]:1e5),t})(),this.world.widthInTiles=30,this.world.heightInTiles=20,this.unitSprites=new Map,this.tiles=new Map,function(e){const t=function(e=Math.random){const t=function(e){const t=512,n=new Uint8Array(t);for(let o=0;o<256;o++)n[o]=o;for(let o=0;o<255;o++){const t=o+~~(e()*(256-o)),r=n[o];n[o]=n[t],n[t]=r}for(let o=256;o<t;o++)n[o]=n[o-256];return n}(e),n=new Float64Array(t).map((e=>we[e%12*2])),o=new Float64Array(t).map((e=>we[e%12*2+1]));return function(e,r){let s=0,i=0,a=0;const c=(e+r)*pe,l=Se(e+c),h=Se(r+c),d=(l+h)*ge,u=e-(l-d),f=r-(h-d);let m,y;u>f?(m=1,y=0):(m=0,y=1);const p=u-m+ge,g=f-y+ge,S=u-1+2*ge,w=f-1+2*ge,b=255&l,E=255&h;let v=.5-u*u-f*f;if(v>=0){const e=b+t[E];v*=v,s=v*v*(n[e]*u+o[e]*f)}let A=.5-p*p-g*g;if(A>=0){const e=b+m+t[E+y];A*=A,i=A*A*(n[e]*p+o[e]*g)}let M=.5-S*S-w*w;if(M>=0){const e=b+1+t[E+1];M*=M,a=M*M*(n[e]*S+o[e]*w)}return 70*(s+i+a)}}();for(let n=0;n<e.heightInTiles;++n)for(let o=0;o<e.widthInTiles;++o){const r=L(e);se(e,be,r),be.row[r]=n,be.col[r]=o;const s=t(n/10,o/10);se(e,ve,r),ve.unit[r]=0,s<-.6?(ve.type[r]=Ee.Sea,ve.cost[r]=0):s<.4?(ve.type[r]=Ee.Plain,ve.cost[r]=1):s<.7?(ve.type[r]=Ee.Tree,ve.cost[r]=2):s<1&&(ve.type[r]=Ee.Forest,ve.cost[r]=3)}}(this.world),function(e){const t=V([ve]),n=(e,t)=>{const n=L(t);return ve.unit[e]=n,se(t,be,n),be.row[n]=be.row[e],be.col[n]=be.col[e],n},o=Y(t)(e).filter((e=>ve.type[e]!=Ee.Sea)).map((e=>({eid:e,sort:Math.random()}))).sort(((e,t)=>e.sort-t.sort)).map((({eid:e})=>e)).slice(0,10);for(let r=0;r<5;r++){const t=o[r],s=n(t,e);se(e,Oe,s),Oe.movement[s]=5,Oe.tile[s]=t,Oe.hp[s]=10*Math.random()+20,Oe.attackPower[s]=9*Math.random()+10,Oe.def[s]=9*Math.random()+0,se(e,Me,s)}for(let r=5;r<10;r++){const t=o[r],s=n(t,e);se(e,Oe,s),Oe.movement[s]=5,Oe.tile[s]=t,Oe.hp[s]=10*Math.random()+20,Oe.attackPower[s]=9*Math.random()+10,Oe.def[s]=9*Math.random()+0,se(e,Ae,s)}}(this.world),this.cameraSystem=function(e){const t=e.cameras.main;return t.setBounds(0,0,1920,1280),e.input.on("pointermove",(e=>{e.isDown&&(t.scrollX-=(e.x-e.prevPosition.x)/t.zoom,t.scrollY-=(e.y-e.prevPosition.y)/t.zoom)})),fe((e=>e))}(this),this.tileSystem=function(e,t){const n=V([ve,be]),o=Y(n);return fe((n=>(o(n).forEach((n=>{const o=new ke(e,64*be.col[n],64*be.row[n],"terrain",ve.type[n]).setOrigin(0).setScale(4);e.add.existing(o),t.set(n,o)})),n)))}(this,this.tiles),this.unitSystem=function(e,t){const n=V([Oe,be]),o=Y(n);return fe((n=>(o(n).forEach((o=>{const r=be.row[o],s=be.col[o],i=((e,t)=>re(t,Me,e)?"player":re(t,Ae,e)?"enemy":re(t,Pe,e)?"ally":void 0)(o,n),a=new je(e,64*s,64*r,i,0);e.add.existing(a),t.set(o,a)})),n)))}(this,this.unitSprites),this.unitSelectionSystem=function(e,t){const n=V([Oe]),o=Y(n),r=V([ye]),s=Y(r),i=$(r),a=V([Te]);let c;return fe((n=>(o(n).forEach((e=>{t.get(e).on("pointerup",(t=>{(t.getDuration()<150||0===t.getDistance())&&(r(n).forEach((e=>ie(n,ye,e))),se(n,ye,e),ye.x[e]=0|t.x,ye.y[e]=0|t.y)}))})),i(n).forEach((()=>{a(n).forEach((e=>ie(n,Te,e))),null!==c&&c.destroy()})),s(n).forEach((t=>{c=new Ce(e,t);const o=function(e,t,n){const o=[];o.push(e);const r=new Map;for(r.set(e,0);o.length>0;){o.sort(((e,t)=>r.get(e)<=r.get(t)?1:-1));const s=o.pop();for(const i of xe(s,n.widthInTiles,n.heightInTiles)){if(ve.type[i]===Ee.Sea)continue;if(0!==ve.unit[i]&&(re(n,Me,ve.unit[i])&&re(n,Ae,ve.unit[e])||re(n,Ae,ve.unit[i])&&re(n,Me,ve.unit[e])))continue;const a=r.get(s)+ve.cost[i];a<=t&&(!r.has(i)||a<r.get(i))&&(r.set(i,a),o.push(i))}}return Array.from(r.keys())}(Oe.tile[t],Oe.movement[t],n);for(const e of o)e!==Oe.tile[t]&&0===ve.unit[e]&&se(n,Te,e)})),n)))}(this,this.unitSprites),this.tintSystem=function(e){const t=V([ye]),n=V([Te]),o=Y(n),r=$(n);return fe((n=>(o(n).forEach((o=>{try{const r=t(n),s=1===r.length?r[0]:(()=>{throw new Error("Expected one selected unit.")})(),i=e.get(o);re(n,Me,s)?i.setTint(8231383,16777215,16777215,16777215):re(n,Ae,s)&&i.setTint(16777215,16777215,16777215,14122365)}catch(r){console.log(r)}})),r(n).forEach((t=>{e.get(t).clearTint()})),n)))}(this.tiles),this.movementSystem=function(e,t){const n=V([ye]),o=V([Te]),r=Y(o),s=$(o);return fe((o=>(r(o).forEach((r=>{const s=e.get(r);s.setInteractive(),s.removeListener("pointerup"),s.on("pointerup",(e=>{try{const s=n(o),i=1===s.length?s[0]:(()=>{throw new Error("Expected one selected unit.")})();if(!re(o,Ie,i)&&(e.getDuration()<150||0===e.getDistance())){const e=Oe.tile[i],s=r;Oe.tile[i]=s,ve.unit[s]=i,ve.unit[e]=0;const a=be.row[s],c=be.col[s];t.get(i).setPosition(16*c*4,16*a*4),se(o,Ie,i),n(o).forEach((e=>ie(o,ye,e)))}}catch(s){console.log(s)}}))})),s(o).forEach((t=>{const n=e.get(t);n.removeListener("pointerup"),n.disableInteractive()})),o)))}(this.tiles,this.unitSprites),this.actionSystem=function(){const e=V([Ie]),t=Y(e);return fe((e=>(t(e).forEach((t=>{(function(e,t,n){const o=[];o.push(e);const r=new Set;for(r.add(e);o.length>0;){const t=o.pop();for(const l of xe(t,n.widthInTiles,n.heightInTiles))ve.type[l]!==Ee.Sea&&!r.has(l)&&(s=be.col[e],i=be.row[e],a=be.col[l],c=be.row[l],Math.abs(s-a)+Math.abs(i-c)<=2)&&(r.add(l),o.push(l))}var s,i,a,c;return Array.from(r)})(Oe.tile[t],0,e).forEach((t=>{0!==ve.unit[t]&&re(e,Ae,ve.unit[t])&&console.log("enemy within range!")}))})),e)))}(),this.phaseSystem=function(e,t,n){const o=V([Oe,Me,Ie]),r=V([Oe,Me,R(Ie)]),s=Y(o),i=V([Oe,Ae,Ie]),a=V([Oe,Ae,R(Ie)]),c=Y(i),l=(o,r,s)=>{const i=e.add.text(e.cameras.main.centerX,e.cameras.main.centerY/4,o,{color:r}).setDepth(100).setScrollFactor(0,0).setOrigin(.5,.5).setScale(2).setStroke("#ffffff",6).setAlpha(0).disableInteractive();e.tweens.chain({targets:i,tweens:[{alpha:{from:0,to:1},delay:1e3,duration:1e3,ease:"Linear",onStart:function(){s(t).forEach((e=>{ie(t,Ie,e),n.get(e).clearTint()}))}},{alpha:{from:1,to:0},delay:3e3,duration:1e3,ease:"Linear",onComplete:function(){i.destroy()}}]})};return a(t).forEach((e=>se(t,Ie,e))),fe((e=>(s(e).forEach((t=>{n.get(t).setTint(8421504),0===r(e).length&&l("Enemy Phase","#ff0000",i)})),c(e).forEach((()=>{0===a(e).length&&l("Player Phase","#0000ff",o)})),e)))}(this,this.world,this.unitSprites);const e=V([ye]);this.input.keyboard.on("keydown-C",(()=>{e(this.world).forEach((e=>{ie(this.world,ye,e)}))}),this)}update(){var e,t,n,o,r,s,i,a;this.world&&(null==(e=this.cameraSystem)||e.call(this,this.world),null==(t=this.tileSystem)||t.call(this,this.world),null==(n=this.unitSystem)||n.call(this,this.world),null==(o=this.unitSelectionSystem)||o.call(this,this.world),null==(r=this.tintSystem)||r.call(this,this.world),null==(s=this.movementSystem)||s.call(this,this.world),null==(i=this.actionSystem)||i.call(this,this.world),null==(a=this.phaseSystem)||a.call(this,this.world))}}class Fe extends n.Scene{constructor(){super({key:"PreloadScene"})}preload(){this.load.spritesheet("terrain","assets/img/terrain.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("player","assets/img/goodChar.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("enemy","assets/img/badChar.png",{frameWidth:16,frameHeight:16}),this.load.image("panel-beige-light","assets/img/panel_beigeLight.png"),this.load.image("panel-brown","assets/img/panel_brown.png"),this.load.image("button-long-beige","assets/img/buttonLong_beige.png")}create(){this.scene.start("MainScene")}}const Re={type:n.WEBGL,backgroundColor:"#000",pixelArt:!0,roundPixels:!0,scale:{parent:"game-container",mode:n.Scale.FIT,autoCenter:window.innerWidth>window.innerHeight?n.Scale.CENTER_BOTH:n.Scale.CENTER_HORIZONTALLY,width:4*(window.innerWidth>window.innerHeight?240:160),height:4*(window.innerWidth>window.innerHeight?160:240)},dom:{createContainer:!0},scene:[Fe,Le]};new n.Game(Re);
