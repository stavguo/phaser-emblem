var e=Object.defineProperty,t=(t,n,r)=>((t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r)(t,"symbol"!=typeof n?n+"":n,r);import{p as n}from"./phaser-C2_wa_Fb.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var r={i8:"i8",ui8:"ui8",ui8c:"ui8c",i16:"i16",ui16:"ui16",i32:"i32",ui32:"ui32",f32:"f32",f64:"f64",eid:"eid"},o={i8:"Int8",ui8:"Uint8",ui8c:"Uint8Clamped",i16:"Int16",ui16:"Uint16",i32:"Int32",ui32:"Uint32",eid:"Uint32",f32:"Float32",f64:"Float64"},s={i8:Int8Array,ui8:Uint8Array,ui8c:Uint8ClampedArray,i16:Int16Array,ui16:Uint16Array,i32:Int32Array,ui32:Uint32Array,f32:Float32Array,f64:Float64Array,eid:Uint32Array},i=e=>4*Math.ceil(e/4),a=Symbol("storeRef"),c=Symbol("storeSize"),l=Symbol("storeMaps"),d=Symbol("storeFlattened"),h=Symbol("storeBase"),u=Symbol("storeType"),f=Symbol("storeArrayElementCounts"),m=Symbol("storeSubarrays"),p=Symbol("subarrayCursors"),y=Symbol("subarray"),g=Symbol("parentArray"),w=Symbol("tagStore"),b=Symbol("indexType"),S=Symbol("indexBytes"),E=Symbol("isEidType"),v={},A=(e,t)=>{e[d]&&e[d].forEach((e=>{ArrayBuffer.isView(e)?e[t]=0:e[t].fill(0)}))},I=e=>Array.isArray(e)&&"string"==typeof e[0]&&"number"==typeof e[1],P=()=>{const e=[],t=[];e.sort=function(n){const r=Array.prototype.sort.call(this,n);for(let o=0;o<e.length;o++)t[e[o]]=o;return r};const n=n=>e[t[n]]===n;return{add:r=>{n(r)||(t[r]=e.push(r)-1)},remove:r=>{if(!n(r))return;const o=t[r],s=e.pop();s!==r&&(e[o]=s,t[s]=o)},has:n,sparse:t,dense:e,reset:()=>{e.length=0,t.length=0}}},M=Symbol("entityMasks"),O=Symbol("entityComponents"),T=Symbol("entitySparseSet"),x=Symbol("entityArray"),C=0,k=[],j=new Map,L=e=>{const t=e[he]?k.length?k.shift():C++:k.length>Math.round(1e3)?k.shift():C++;if(t>e[ie])throw new Error("bitECS - max entities reached");return e[T].add(t),j.set(t,e),e[D].forEach((n=>{V(e,n,t)&&J(n,t)})),e[O].set(t,new Set),t},F=Symbol("$modifier"),R=Symbol("queries"),D=Symbol("notQueries"),N=Symbol("queryAny"),U=Symbol("queryAll"),q=Symbol("queryNone"),B=Symbol("queryMap"),_=Symbol("$dirtyQueries"),H=Symbol("queryComponents"),W=Object.freeze([]),z=e=>t=>{t[B].has(e)||Y(t,e);const n=t[B].get(e);if(0===n.entered.dense.length)return W;{const e=n.entered.dense.slice();return n.entered.reset(),e}},G=e=>t=>{t[B].has(e)||Y(t,e);const n=t[B].get(e);if(0===n.exited.dense.length)return W;{const e=n.exited.dense.slice();return n.exited.reset(),e}},Y=(e,t)=>{const n=[],r=[],o=[];t[H].forEach((t=>{if("function"==typeof t&&t[F]){const[s,i]=t();e[ee].has(s)||ne(e,s),"not"===i&&r.push(s),"changed"===i&&(o.push(s),n.push(s))}else e[ee].has(t)||ne(e,t),n.push(t)}));const s=t=>e[ee].get(t),i=n.concat(r).map(s),a=P(),c=P(),l=P(),h=P(),u=i.map((e=>e.generationId)).reduce(((e,t)=>(e.includes(t)||e.push(t),e)),[]),f=(e,t)=>(e[t.generationId]||(e[t.generationId]=0),e[t.generationId]|=t.bitflag,e),m=n.map(s).reduce(f,{}),p=r.map(s).reduce(f,{}),y=i.reduce(f,{}),g=n.filter((e=>!e[w])).map((e=>Object.getOwnPropertySymbols(e).includes(d)?e[d]:[e])).reduce(((e,t)=>e.concat(t)),[]),b=Object.assign(a,{archetypes:[],changed:[],components:n,notComponents:r,changedComponents:o,allComponents:i,masks:m,notMasks:p,hasMasks:y,generations:u,flatProps:g,toRemove:c,entered:l,exited:h,shadows:[]});e[B].set(t,b),e[R].add(b),i.forEach((e=>{e.queries.add(b)})),r.length&&e[D].add(b);for(let d=0;d<C;d++)e[T].has(d)&&V(e,b,d)&&J(b,d)},$=(e,t)=>{const n=Symbol(),r=e.flatProps[t];return((e,t)=>{if(ArrayBuffer.isView(e))e[t]=e.slice(0);else{const n=e[g].slice(0);e[t]=e.map(((t,r)=>{const{length:o}=e[r],s=o*r,i=s+o;return n.subarray(s,i)}))}})(r,n),e.shadows[t]=r[n],r[n]},Q=(...e)=>{let t;if(Array.isArray(e[0])&&(t=e[0]),void 0===t||void 0!==t[ee])return e=>e?e[x]:t[x];const n=function(e,t=!0){e[B].has(n)||Y(e,n);const r=e[B].get(n);return K(e),r.changedComponents.length?((e,t)=>{t&&(e.changed=[]);const{flatProps:n,shadows:r}=e;for(let o=0;o<e.dense.length;o++){const t=e.dense[o];let s=!1;for(let o=0;o<n.length;o++){const i=n[o],a=r[o]||$(e,o);if(ArrayBuffer.isView(i[t])){for(let e=0;e<i[t].length;e++)if(i[t][e]!==a[t][e]){s=!0;break}a[t].set(i[t])}else i[t]!==a[t]&&(s=!0,a[t]=i[t])}s&&e.changed.push(t)}return e.changed})(r,t):r.dense};return n[H]=t,n[N]=void 0,n[U]=void 0,n[q]=void 0,n},V=(e,t,n)=>{const{masks:r,notMasks:o,generations:s}=t;for(let i=0;i<s.length;i++){const t=s[i],a=r[t],c=o[t],l=e[M][t][n];if(c&&l&c)return!1;if(a&&(l&a)!==a)return!1}return!0},J=(e,t)=>{e.toRemove.remove(t),e.entered.add(t),e.add(t)},X=e=>{for(let t=e.toRemove.dense.length-1;t>=0;t--){const n=e.toRemove.dense[t];e.toRemove.remove(n),e.remove(n)}},K=e=>{e[_].size&&(e[_].forEach(X),e[_].clear())},Z=(e,t,n)=>{t.has(n)&&!t.toRemove.has(n)&&(t.toRemove.add(n),e[_].add(t),t.exited.add(n))},ee=Symbol("componentMap"),te=(e,t)=>{const n=((e,t)=>{const n=Symbol("store");if(!e||!Object.keys(e).length)return v[n]={[c]:t,[w]:!0,[h]:()=>v[n]},v[n];e=JSON.parse(JSON.stringify(e));const A={},P=e=>{const t=Object.keys(e);for(const n of t)I(e[n])?(A[e[n][0]]||(A[e[n][0]]=0),A[e[n][0]]+=e[n][1]):e[n]instanceof Object&&P(e[n])};P(e);const M={[c]:t,[l]:{},[m]:{},[a]:n,[p]:Object.keys(s).reduce(((e,t)=>({...e,[t]:0})),{}),[d]:[],[f]:A};if(e instanceof Object&&Object.keys(e).length){const a=(e,l)=>{if("string"==typeof e[l])e[l]=((e,t)=>{const n=t*s[e].BYTES_PER_ELEMENT,o=new ArrayBuffer(n),i=new s[e](o);return i[E]=e===r.eid,i})(e[l],t),e[l][h]=()=>v[n],M[d].push(e[l]);else if(I(e[l])){const[t,a]=e[l];e[l]=((e,t,n)=>{const a=e[c],l=Array(a).fill(0);l[u]=t,l[E]=t===r.eid;const d=e[p],h=n<=256?r.ui8:n<=65536?r.ui16:r.ui32;if(!n)throw new Error("bitECS - Must define component array length");if(!s[t])throw new Error(`bitECS - Invalid component array property type ${t}`);if(!e[m][t]){const n=e[f][t],r=new s[t](i(n*a));r[b]=o[h],r[S]=s[h].BYTES_PER_ELEMENT,e[m][t]=r}const w=d[t],v=w+a*n;d[t]=v,l[g]=e[m][t].subarray(w,v);for(let r=0;r<a;r++){const e=n*r,t=e+n;l[r]=l[g].subarray(e,t),l[r][b]=o[h],l[r][S]=s[h].BYTES_PER_ELEMENT,l[r][y]=!0}return l})(M,t,a),e[l][h]=()=>v[n],M[d].push(e[l])}else e[l]instanceof Object&&(e[l]=Object.keys(e[l]).reduce(a,e[l]));return e};return v[n]=Object.assign(Object.keys(e).reduce(a,e),M),v[n][h]=()=>v[n],v[n]}})(e,1e5);return e&&Object.keys(e).length,n},ne=(e,t)=>{if(!t)throw new Error("bitECS - Cannot register null or undefined component");const n=new Set,r=new Set,o=new Set;e[R].forEach((e=>{e.allComponents.includes(t)&&n.add(e)})),e[ee].set(t,{generationId:e[M].length-1,bitflag:e[ae],store:t,queries:n,notQueries:r,changedQueries:o}),(e=>{e[ae]*=2,e[ae]>=2**31&&(e[ae]=1,e[M].push(new Uint32Array(e[ie])))})(e)},re=(e,t,n)=>{const r=e[ee].get(t);if(!r)return!1;const{generationId:o,bitflag:s}=r;return(e[M][o][n]&s)===s},oe=(e,t,n,r=!1)=>{if(void 0===n)throw new Error("bitECS - entity is undefined.");if(!e[T].has(n))throw new Error("bitECS - entity does not exist in the world.");if(e[ee].has(t)||ne(e,t),re(e,t,n))return;const o=e[ee].get(t),{generationId:s,bitflag:i,queries:a,notQueries:c}=o;e[M][s][n]|=i,a.forEach((t=>{t.toRemove.remove(n);const r=V(e,t,n);r&&(t.exited.remove(n),J(t,n)),r||(t.entered.remove(n),Z(e,t,n))})),e[O].get(n).add(t),r&&A(t,n)},se=(e,t,n,r=!0)=>{if(void 0===n)throw new Error("bitECS - entity is undefined.");if(!e[T].has(n))throw new Error("bitECS - entity does not exist in the world.");if(!re(e,t,n))return;const o=e[ee].get(t),{generationId:s,bitflag:i,queries:a}=o;e[M][s][n]&=~i,a.forEach((t=>{t.toRemove.remove(n);const r=V(e,t,n);r&&(t.exited.remove(n),J(t,n)),r||(t.entered.remove(n),Z(e,t,n))})),e[O].get(n).delete(t),r&&A(t,n)},ie=Symbol("size"),ae=Symbol("bitflag"),ce=Symbol("archetypes"),le=Symbol("localEntities"),de=Symbol("localEntityLookup"),he=Symbol("manualEntityRecycling"),ue=e=>(t,...n)=>(e(t,...n),t),fe=r;const me=te({x:fe.i32,y:fe.i32}),pe=.5*(Math.sqrt(3)-1),ye=(3-Math.sqrt(3))/6,ge=e=>0|Math.floor(e),we=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]);const be=te({row:fe.ui16,col:fe.ui16});var Se=(e=>(e[e.Sea=0]="Sea",e[e.Plain=1]="Plain",e[e.Tree=2]="Tree",e[e.Forest=3]="Forest",e))(Se||{});const Ee=te({type:fe.ui8,cost:fe.ui8,unit:fe.eid});var ve=(e=>(e[e.Player=0]="Player",e[e.Enemy=1]="Enemy",e[e.Ally=2]="Ally",e[e.Neutral=3]="Neutral",e))(ve||{});const Ae=te({movement:fe.ui8,tile:fe.eid,hp:fe.ui8,attackPower:fe.ui8,def:fe.ui8,team:fe.ui8}),Ie=te();function Pe(e,t,n){const r=[],o=t*e.widthInTiles+n;return t>0&&r.push(e.tiles[o-e.widthInTiles]),t<e.heightInTiles&&r.push(e.tiles[o+e.widthInTiles]),n>0&&r.push(e.tiles[o-1]),n<e.widthInTiles&&r.push(e.tiles[o+1]),r}const Me=te(),Oe=te();class Te extends n.GameObjects.Container{constructor(e,t,r,o){super(e,me.x[t]>e.scale.width/2?5:e.scale.width-5-r,5),this.setDepth(100).setScrollFactor(0,0).disableInteractive();const s=e.add.nineslice(0,0,"panel-brown",0,r/2,r/2,60,40,49,49).setOrigin(0,0).setScale(2);this.add(s);const i=new n.Geom.Line(15,15,15,15+o),a=[],c=e.add.text(0,0,`HP: ${Ae.hp[t].toString()}`,{color:"#000000"}).setDepth(102).setScrollFactor(0,0).setOrigin(0,0);a.push(c);const l=e.add.text(0,0,`Attack Power: ${Ae.attackPower[t].toString()}`,{color:"#000000"}).setDepth(102).setScrollFactor(0,0).setOrigin(0,0);a.push(l);const d=e.add.text(0,0,`Defense: ${Ae.def[t].toString()}`,{color:"#000000"}).setDepth(102).setScrollFactor(0,0).setOrigin(0,0);a.push(d),n.Actions.PlaceOnLine(a,i),this.add(a),e.input.on("pointerup",(()=>{null!==this&&1!==this.alpha&&this.setAlpha(1)})),e.input.on("pointermove",(e=>{e.isDown&&null!==this&&1===this.alpha&&this.setAlpha(.7)}))}}class xe extends n.Scene{constructor(){super({key:"MainScene"}),t(this,"world"),t(this,"unitSprites"),t(this,"tiles")}create(){this.world=((...e)=>{const t="object"==typeof e[0]?e[0]:{};return((e,t=1e5)=>{e[ie]=t,e[x]&&e[x].forEach((t=>((e,t)=>{if(e[T].has(t)){e[R].forEach((n=>{Z(e,n,t)})),e[he]||k.push(t),e[T].remove(t),e[O].delete(t),e[le].delete(e[de].get(t)),e[de].delete(t);for(let n=0;n<e[M].length;n++)e[M][n][t]=0}})(e,t))),e[M]=[new Uint32Array(t)],e[O]=new Map,e[ce]=[],e[T]=P(),e[x]=e[T].dense,e[ae]=1,e[ee]=new Map,e[B]=new Map,e[R]=new Set,e[D]=new Set,e[_]=new Set,e[le]=new Map,e[de]=new Map,e[he]=!1})(t,"number"==typeof e[0]?e[0]:"number"==typeof e[1]?e[1]:1e5),t})(),this.world.widthInTiles=30,this.world.heightInTiles=20,this.world.selected=0,this.world.tiles=new Uint32Array(this.world.widthInTiles*this.world.heightInTiles),this.unitSprites=new Map,this.tiles=new Map,function(e){const t=e.cameras.main;t.setBounds(0,0,1920,1280),e.input.on("pointermove",(e=>{e.isDown&&(t.scrollX-=(e.x-e.prevPosition.x)/t.zoom,t.scrollY-=(e.y-e.prevPosition.y)/t.zoom)}))}(this),function(e){const t=function(e=Math.random){const t=function(e){const t=512,n=new Uint8Array(t);for(let r=0;r<256;r++)n[r]=r;for(let r=0;r<255;r++){const t=r+~~(e()*(256-r)),o=n[r];n[r]=n[t],n[t]=o}for(let r=256;r<t;r++)n[r]=n[r-256];return n}(e),n=new Float64Array(t).map((e=>we[e%12*2])),r=new Float64Array(t).map((e=>we[e%12*2+1]));return function(e,o){let s=0,i=0,a=0;const c=(e+o)*pe,l=ge(e+c),d=ge(o+c),h=(l+d)*ye,u=e-(l-h),f=o-(d-h);let m,p;u>f?(m=1,p=0):(m=0,p=1);const y=u-m+ye,g=f-p+ye,w=u-1+2*ye,b=f-1+2*ye,S=255&l,E=255&d;let v=.5-u*u-f*f;if(v>=0){const e=S+t[E];v*=v,s=v*v*(n[e]*u+r[e]*f)}let A=.5-y*y-g*g;if(A>=0){const e=S+m+t[E+p];A*=A,i=A*A*(n[e]*y+r[e]*g)}let I=.5-w*w-b*b;if(I>=0){const e=S+1+t[E+1];I*=I,a=I*I*(n[e]*w+r[e]*b)}return 70*(s+i+a)}}();for(let n=0;n<e.heightInTiles;++n)for(let r=0;r<e.widthInTiles;++r){const o=L(e);e.tiles[n*e.widthInTiles+r]=o,oe(e,be,o),be.row[o]=n,be.col[o]=r;const s=t(n/10,r/10);oe(e,Ee,o),Ee.unit[o]=0,s<-.6?(Ee.type[o]=Se.Sea,Ee.cost[o]=0):s<.4?(Ee.type[o]=Se.Plain,Ee.cost[o]=1):s<.7?(Ee.type[o]=Se.Tree,Ee.cost[o]=2):s<1&&(Ee.type[o]=Se.Forest,Ee.cost[o]=3)}}(this.world),function(e){const t=Q([Ee]),n=(e,t)=>{const n=L(t);return Ee.unit[e]=n,oe(t,be,n),be.row[n]=be.row[e],be.col[n]=be.col[e],n},r=z(t)(e).filter((e=>Ee.type[e]!=Se.Sea)).map((e=>({eid:e,sort:Math.random()}))).sort(((e,t)=>e.sort-t.sort)).map((({eid:e})=>e)).slice(0,10);for(let o=0;o<5;o++){const t=r[o],s=n(t,e);oe(e,Ae,s),Ae.movement[s]=5,Ae.tile[s]=t,Ae.hp[s]=10*Math.random()+20,Ae.attackPower[s]=9*Math.random()+10,Ae.def[s]=9*Math.random()+0,Ae.team[s]=ve.Player}for(let o=5;o<10;o++){const t=r[o],s=n(t,e);oe(e,Ae,s),Ae.movement[s]=5,Ae.tile[s]=t,Ae.hp[s]=10*Math.random()+20,Ae.attackPower[s]=9*Math.random()+10,Ae.def[s]=9*Math.random()+0,Ae.team[s]=ve.Enemy}}(this.world);const e=((...e)=>t=>{let n=t;for(let r=0;r<e.length;r++)n=(0,e[r])(n);return n})(function(e,t){const r=Q([Ee,be]),o=z(r);return ue((r=>(o(r).forEach((r=>{const o=new n.GameObjects.Image(e,64*be.col[r],64*be.row[r],"terrain",Ee.type[r]).setScale(4).setOrigin(0).setDepth(1).disableInteractive();e.add.existing(o),t.set(r,o)})),r)))}(this,this.tiles),function(e,t){const r=Q([Ae,be]),o=z(r),s=["player","enemy","ally","neutral"];return ue((r=>(o(r).forEach((r=>{const o=be.row[r],i=be.col[r],a=new n.GameObjects.Sprite(e,64*i,64*o,s[Ae.team[r]],0).setScale(4).setOrigin(0).setDepth(1).setInteractive();e.add.existing(a),t.set(r,a)})),r)))}(this,this.unitSprites),function(e){const t=Q([Ae]),n=z(t),r=Q([me]),o=z(r),s=G(r),i=Q([Oe,Ee]),a=(e,t,n)=>{(e.getDuration()<150||0===e.getDistance())&&(0!==n.selected&&re(n,me,n.selected)&&se(n,me,n.selected),n.selected=t,oe(n,me,t),me.x[t]=0|e.x,me.y[t]=0|e.y)};return ue((t=>(n(t).forEach((n=>{const r=e.get(n);r.setInteractive(),r.on("pointerup",(e=>a(e,n,t)))})),s(t).forEach((n=>{const r=e.get(n);r.setInteractive(),r.on("pointerup",(e=>a(e,n,t))),i(t).forEach((e=>se(t,Oe,e)))})),o(t).forEach((n=>{const r=e.get(n);if(r.removeListener("pointerup"),r.disableInteractive(),!re(t,Ie,n)&&re(t,Me,n)){const e=function(e,t,n){const r=[];r.push(e);const o=new Map;for(o.set(e,0);r.length>0;){r.sort(((e,t)=>o.get(e)<=o.get(t)?1:-1));const s=r.pop();for(const i of Pe(n,be.row[s],be.col[s])){if(Ee.type[i]===Se.Sea)continue;if(0!==Ee.unit[i]){const t=Ee.unit[e],n=Ee.unit[i];if(Ae.team[t]===ve.Player&&Ae.team[n]===ve.Enemy||Ae.team[n]===ve.Player&&Ae.team[t]===ve.Enemy)continue}const n=o.get(s)+Ee.cost[i];n<=t&&(!o.has(i)||n<o.get(i))&&(o.set(i,n),r.push(i))}}return Array.from(o.keys())}(Ae.tile[n],Ae.movement[n],t);for(const r of e)0!==Ee.unit[r]&&r!==Ae.tile[n]||oe(t,Oe,r)}})),t)))}(this.unitSprites),function(e,t){const n=Q([Oe,Ae]),r=z(n),o=G(n),s=Q([Oe,Ee]),i=z(s),a=G(s);return ue((n=>(i(n).forEach((t=>{const r=e.get(t);Ae.team[n.selected]===ve.Player?r.setTint(8231383,16777215,16777215,16777215):Ae.team[n.selected]===ve.Enemy&&r.setTint(16777215,16777215,16777215,14122365)})),a(n).forEach((t=>{e.get(t).clearTint()})),r(n).forEach((e=>{t.get(e).setTint(8421504)})),o(n).forEach((e=>{t.get(e).clearTint()})),n)))}(this.tiles,this.unitSprites),function(e,t){const n=Q([Oe,Ee]),r=z(n),o=G(n);return ue((s=>(r(s).forEach((r=>{const o=e.get(r);o.setInteractive(),o.removeListener("pointerup"),o.on("pointerup",(e=>{if(!re(s,Ie,s.selected)&&(e.getDuration()<150||0===e.getDistance())){const e=Ae.tile[s.selected],o=r;Ae.tile[s.selected]=o,Ee.unit[o]=s.selected,Ee.unit[e]=0;const i=be.row[o],a=be.col[o];t.get(s.selected).setPosition(16*a*4,16*i*4),n(s).forEach((e=>se(s,Oe,e))),oe(s,Ie,s.selected),se(s,Me,s.selected),oe(s,Oe,s.selected),se(s,me,s.selected)}}))})),o(s).forEach((t=>{const n=e.get(t);n.removeListener("pointerup"),n.disableInteractive()})),s)))}(this.tiles,this.unitSprites),function(){const e=Q([Ie]),t=z(e);return ue((e=>(t(e).forEach((t=>{(function(e,t,n){const r=[];r.push(e);const o=new Set;for(o.add(e);r.length>0;){const t=r.pop();for(const l of Pe(n,be.row[t],be.col[t]))Ee.type[l]!==Se.Sea&&!o.has(l)&&(s=be.col[e],i=be.row[e],a=be.col[l],c=be.row[l],Math.abs(s-a)+Math.abs(i-c)<=2)&&(o.add(l),r.push(l))}var s,i,a,c;return Array.from(o)})(Ae.tile[t],0,e).forEach((e=>{0!==Ee.unit[e]&&Ae.team[Ee.unit[e]]===ve.Enemy&&console.log("enemy within range!")}))})),e)))}(),function(e,t){const n=Q([Ae,Me]),r=Q([Ae,(c=Me,function(e,t){const n=()=>[e,"not"];return n[F]=!0,n}(c))]),o=G(n),s=e=>r(e).filter((e=>Ae.team[e]===ve.Player)),i=e=>r(e).filter((e=>Ae.team[e]===ve.Enemy)),a=(n,r,o,s)=>{const i=e.add.text(e.cameras.main.centerX,e.cameras.main.centerY/4,n,{color:r}).setDepth(100).setScrollFactor(0,0).setOrigin(.5,.5).setScale(2).setStroke("#ffffff",6).setAlpha(0).disableInteractive();e.tweens.chain({targets:i,tweens:[{alpha:{from:0,to:1},delay:1e3,duration:1e3,ease:"Linear",onStart:function(){o.forEach((e=>{oe(t,Me,e),re(t,Ie,e)&&se(t,Ie,e),se(t,Oe,e)})),s.forEach((e=>{se(t,Oe,e)}))}},{alpha:{from:1,to:0},delay:3e3,duration:1e3,ease:"Linear",onComplete:function(){i.destroy()}}]})};var c;return a("Player Phase","#0000ff",s(t),i(t)),ue((e=>(o(e).forEach((t=>{Ae.team[t]===ve.Player?(oe(e,Oe,t),0===(e=>n(e).filter((e=>Ae.team[e]===ve.Player)))(e).length&&a("Enemy Phase","#ff0000",i(e),s(e))):Ae.team[t]===ve.Enemy&&0===(e=>n(e).filter((e=>Ae.team[e]===ve.Enemy)))(e).length&&a("Player Phase","#0000ff",s(e),i(e))})),e)))}(this,this.world),function(e){const t=Q([me]),n=z(t),r=G(t),o=new Map;return ue((t=>(n(t).forEach((t=>{const n=new Te(e,t,200,200);e.add.existing(n),o.set(t,n)})),r(t).forEach((e=>{var t;null==(t=o.get(e))||t.destroy(),o.delete(e)})),t)))}(this));this.update=()=>{e(this.world)};const t=Q([me]);this.input.keyboard.on("keydown-C",(()=>{t(this.world).forEach((e=>{se(this.world,me,e)}))}),this)}}class Ce extends n.Scene{constructor(){super({key:"PreloadScene"})}preload(){this.load.spritesheet("terrain","assets/img/terrain.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("player","assets/img/goodChar.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("enemy","assets/img/badChar.png",{frameWidth:16,frameHeight:16}),this.load.image("panel-beige-light","assets/img/panel_beigeLight.png"),this.load.image("panel-brown","assets/img/panel_brown.png"),this.load.image("button-long-beige","assets/img/buttonLong_beige.png")}create(){this.scene.start("MainScene")}}const ke={type:n.WEBGL,backgroundColor:"#000",pixelArt:!0,roundPixels:!0,scale:{parent:"game-container",mode:n.Scale.FIT,autoCenter:window.innerWidth>window.innerHeight?n.Scale.CENTER_BOTH:n.Scale.CENTER_HORIZONTALLY,width:4*(window.innerWidth>window.innerHeight?240:160),height:4*(window.innerWidth>window.innerHeight?160:240)},dom:{createContainer:!0},scene:[Ce,xe]};new n.Game(ke);
